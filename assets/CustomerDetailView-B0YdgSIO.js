import{V as P,r as v,c as x,O as R,M as $,X as q,o as A,R as E,x as H,Y as L,a as z,k as Y,G,L as I,H as Q,Q as U,p as l,f as e,e as n,q as X,B as J,t as a,h as b,w as K,F as k,i as D,D as W,g as Z,T as ee,y as N,z as T}from"./index-qMo-vOBa.js";import{A as te}from"./arrow-left-Dy8JKM38.js";function se(m,f,d){return P(m,-7,d)}const oe={class:"container mx-auto max-w-6xl px-4 py-8"},ae={class:"mb-8"},re={class:"rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-700 p-6 md:p-8 shadow-lg"},le={class:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"},ne={class:"text-3xl md:text-4xl font-bold text-white"},de={class:"flex flex-col gap-4 sm:flex-row sm:items-end lg:items-center"},ie={class:"text-left sm:text-right"},ce={class:"text-sm font-medium text-blue-100 mb-1"},ue={class:"text-xs ml-1"},xe={class:"text-3xl md:text-4xl font-bold text-white"},be={class:"flex flex-col gap-1"},me=["value"],ge={key:0,class:"flex h-64 items-center justify-center"},pe={key:1,class:"rounded-2xl border border-gray-200 bg-white shadow-md overflow-hidden"},ve={class:"border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},fe={class:"text-lg font-bold text-gray-800"},he={key:0,class:"px-6 py-12 text-center"},ye={key:1,class:"overflow-x-auto"},we={class:"min-w-full divide-y divide-gray-200"},_e={class:"divide-y divide-gray-200 bg-white"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},De={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ne={class:"px-6 py-4 whitespace-nowrap"},Te={class:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900"},Ce={key:2,class:"border-t border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},Me={class:"flex items-center justify-between"},Se={class:"text-sm text-gray-700 font-medium"},Be={class:"font-bold text-blue-600"},Fe={class:"font-bold text-gray-900"},Ve={class:"flex gap-2"},je=["disabled"],Oe=["disabled"],y=10,$e={__name:"CustomerDetailView",props:{name:{type:String,required:!0}},setup(m){const f=m,d=v(!0),i=v([]),r=v(1),c=v("all"),w=[{value:"all",label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"},{value:"7days",label:"7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"},{value:"month",label:"‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ"},{value:"year",label:"‡∏õ‡∏µ‡∏ô‡∏µ‡πâ"}],C=x(()=>{const o=w.find(t=>t.value===c.value);return o?o.label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"}),g=x(()=>{if(c.value==="all")return i.value;const o=new Date;let t;switch(c.value){case"7days":t=se(o);break;case"month":t=$(o);break;case"year":t=R(o);break;default:return i.value}return i.value.filter(s=>(s.dateTime?.toDate?s.dateTime.toDate():new Date(s.dateTime))>=t)}),M=x(()=>g.value.reduce((o,t)=>{const s=parseFloat(t.amount);return o+(isNaN(s)?0:s)},0)),p=x(()=>Math.ceil(g.value.length/y)),S=x(()=>{const o=(r.value-1)*y,t=o+y;return g.value.slice(o,t)}),h=async()=>{d.value=!0;try{const o=z(Y,"sales"),t=G(o,I("customerName","==",f.name),Q("dateTime","desc")),s=await U(t);i.value=s.docs.map(u=>({id:u.id,...u.data()}))}catch(o){console.error("Error fetching customer sales:",o)}finally{d.value=!1}},B=o=>{if(!o)return"-";const t=o.toDate?o.toDate():new Date(o),s=N(t,"d MMM",{locale:T}),u=t.getFullYear()+543,j=String(u).slice(-2),O=N(t,"HH:mm",{locale:T});return`${s} ${j} ${O} ‡∏ô.`},_=o=>{const t=parseFloat(o);return new Intl.NumberFormat("th-TH").format(isNaN(t)?0:t)},F=()=>{r.value<p.value&&r.value++},V=()=>{r.value>1&&r.value--};return q(()=>f.name,()=>{r.value=1,h()}),A(()=>{h()}),(o,t)=>(l(),E(L,{"on-refresh":h},{default:H(()=>[e("div",oe,[e("div",ae,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.back()),class:"mb-4 inline-flex items-center gap-2 bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:bg-gray-50 hover:text-blue-600 hover:border-blue-300 transition-all"},[X(J(te),{class:"h-5 w-5"}),t[2]||(t[2]=e("span",{class:"font-medium"},"‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö",-1))]),e("div",re,[e("div",le,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-blue-100 mb-2"},"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",-1)),e("h1",ne,a(m.name),1)]),e("div",de,[e("div",ie,[e("p",ce,[t[4]||(t[4]=b(" ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏°",-1)),e("span",ue,"("+a(C.value)+")",1)]),e("h2",xe," ‡∏ø"+a(_(M.value)),1)]),e("div",be,[t[5]||(t[5]=e("label",{class:"text-xs font-medium text-blue-100"},"‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤",-1)),K(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s),class:"bg-white/95 border border-white/30 text-gray-700 text-sm rounded-lg focus:ring-2 focus:ring-white focus:border-white block px-3 py-2.5 shadow-md backdrop-blur-sm min-w-[150px]"},[(l(),n(k,null,D(w,s=>e("option",{key:s.value,value:s.value},a(s.label),9,me)),64))],512),[[W,c.value]])])])])])]),d.value?(l(),n("div",ge,[...t[6]||(t[6]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),e("p",{class:"text-sm text-gray-500"},"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...")],-1)])])):(l(),n("div",pe,[e("div",ve,[e("h3",fe," üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ("+a(g.value.length)+" ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ",1)]),i.value.length===0?(l(),n("div",he,[...t[7]||(t[7]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"text-4xl"},"üì≠"),e("p",{class:"text-gray-500 font-medium"},"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠")],-1)])])):(l(),n("div",ye,[e("table",we,[t[8]||(t[8]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Order No. "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ")])],-1)),e("tbody",_e,[(l(!0),n(k,null,D(S.value,s=>(l(),n("tr",{key:s.id,class:"hover:bg-blue-50/50 transition-colors"},[e("td",ke,a(B(s.dateTime)),1),e("td",De,a(s.orderNo||"-"),1),e("td",Ne,[e("span",{class:ee(["inline-flex rounded-full px-3 py-1 text-xs font-semibold leading-5",{"bg-orange-100 text-orange-800 border border-orange-200":s.type==="COD","bg-emerald-100 text-emerald-800 border border-emerald-200":s.type==="TRANSFER"}])},a(s.type||"N/A"),3)]),e("td",Te," ‡∏ø"+a(_(s.amount)),1)]))),128))])])])),p.value>1?(l(),n("div",Ce,[e("div",Me,[e("div",Se,[t[9]||(t[9]=b(" ‡∏´‡∏ô‡πâ‡∏≤ ",-1)),e("span",Be,a(r.value),1),t[10]||(t[10]=b(" ‡∏à‡∏≤‡∏Å ",-1)),e("span",Fe,a(p.value),1)]),e("div",Ve,[e("button",{onClick:V,disabled:r.value===1,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[11]||(t[11]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),b(" ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ",-1)])],8,je),e("button",{onClick:F,disabled:r.value===p.value,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[12]||(t[12]=[b(" ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ",-1),e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Oe)])])])):Z("",!0)]))])]),_:1}))}};export{$e as default};
