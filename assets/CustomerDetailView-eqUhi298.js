import{N as V,r as m,c as u,O as j,P as M,Q as P,o as O,g as R,q,R as A,a as E,l as L,U as z,V as I,X as U,Y,n as l,f as e,e as n,p as $,u as k,t as a,h as x,w as H,F as D,j as N,E as Q,i as X,s as G,I as J}from"./index-B3zZU_Hv.js";import{A as K}from"./arrow-left-BsvjtutR.js";function W(b,v,d){return V(b,-7,d)}const Z={class:"container mx-auto max-w-6xl px-4 py-8"},ee={class:"mb-8"},te={class:"rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-700 p-6 md:p-8 shadow-lg"},se={class:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"},oe={class:"text-3xl md:text-4xl font-bold text-white"},ae={class:"flex flex-col gap-4 sm:flex-row sm:items-end lg:items-center"},re={class:"text-left sm:text-right"},le={class:"text-sm font-medium text-blue-100 mb-1"},ne={class:"text-xs ml-1"},de={class:"text-3xl md:text-4xl font-bold text-white"},ie={class:"flex flex-col gap-1"},ce=["value"],ue={key:0,class:"flex h-64 items-center justify-center"},xe={key:1,class:"rounded-2xl border border-gray-200 bg-white shadow-md overflow-hidden"},be={class:"border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},pe={class:"text-lg font-bold text-gray-800"},ge={key:0,class:"px-6 py-12 text-center"},me={key:1,class:"overflow-x-auto"},ve={class:"min-w-full divide-y divide-gray-200"},fe={class:"divide-y divide-gray-200 bg-white"},he={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},ye={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},we={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900"},ke={key:2,class:"border-t border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},De={class:"flex items-center justify-between"},Ne={class:"text-sm text-gray-700 font-medium"},Ce={class:"font-bold text-blue-600"},Te={class:"font-bold text-gray-900"},Fe={class:"flex gap-2"},Se=["disabled"],Be=["disabled"],y=10,Me={__name:"CustomerDetailView",props:{name:{type:String,required:!0}},setup(b){const v=b,d=m(!0),i=m([]),r=m(1),c=m("all"),w=[{value:"all",label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"},{value:"7days",label:"7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"},{value:"month",label:"‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ"},{value:"year",label:"‡∏õ‡∏µ‡∏ô‡∏µ‡πâ"}],C=u(()=>{const o=w.find(t=>t.value===c.value);return o?o.label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"}),p=u(()=>{if(c.value==="all")return i.value;const o=new Date;let t;switch(c.value){case"7days":t=W(o);break;case"month":t=M(o);break;case"year":t=j(o);break;default:return i.value}return i.value.filter(s=>(s.dateTime?.toDate?s.dateTime.toDate():new Date(s.dateTime))>=t)}),T=u(()=>p.value.reduce((o,t)=>{const s=parseFloat(t.amount);return o+(isNaN(s)?0:s)},0)),g=u(()=>Math.ceil(p.value.length/y)),F=u(()=>{const o=(r.value-1)*y,t=o+y;return p.value.slice(o,t)}),f=async()=>{d.value=!0;try{const o=E(L,"sales"),t=z(o,I("customerName","==",v.name),U("dateTime","desc")),s=await Y(t);i.value=s.docs.map(h=>({id:h.id,...h.data()}))}catch(o){console.error("Error fetching customer sales:",o)}finally{d.value=!1}},_=o=>{const t=parseFloat(o);return new Intl.NumberFormat("th-TH").format(isNaN(t)?0:t)},S=()=>{r.value<g.value&&r.value++},B=()=>{r.value>1&&r.value--};return P(()=>v.name,()=>{r.value=1,f()}),O(()=>{f()}),(o,t)=>(l(),R(A,{"on-refresh":f},{default:q(()=>[e("div",Z,[e("div",ee,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.back()),class:"mb-4 inline-flex items-center gap-2 bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:bg-gray-50 hover:text-blue-600 hover:border-blue-300 transition-all"},[$(k(K),{class:"h-5 w-5"}),t[2]||(t[2]=e("span",{class:"font-medium"},"‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö",-1))]),e("div",te,[e("div",se,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-blue-100 mb-2"},"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",-1)),e("h1",oe,a(b.name),1)]),e("div",ae,[e("div",re,[e("p",le,[t[4]||(t[4]=x(" ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏°",-1)),e("span",ne,"("+a(C.value)+")",1)]),e("h2",de," ‡∏ø"+a(_(T.value)),1)]),e("div",ie,[t[5]||(t[5]=e("label",{class:"text-xs font-medium text-blue-100"},"‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤",-1)),H(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s),class:"bg-white/95 border border-white/30 text-gray-700 text-sm rounded-lg focus:ring-2 focus:ring-white focus:border-white block px-3 py-2.5 shadow-md backdrop-blur-sm min-w-[150px]"},[(l(),n(D,null,N(w,s=>e("option",{key:s.value,value:s.value},a(s.label),9,ce)),64))],512),[[Q,c.value]])])])])])]),d.value?(l(),n("div",ue,[...t[6]||(t[6]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),e("p",{class:"text-sm text-gray-500"},"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...")],-1)])])):(l(),n("div",xe,[e("div",be,[e("h3",pe," üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ("+a(p.value.length)+" ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ",1)]),i.value.length===0?(l(),n("div",ge,[...t[7]||(t[7]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"text-4xl"},"üì≠"),e("p",{class:"text-gray-500 font-medium"},"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠")],-1)])])):(l(),n("div",me,[e("table",ve,[t[8]||(t[8]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Order No. "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ")])],-1)),e("tbody",fe,[(l(!0),n(D,null,N(F.value,s=>(l(),n("tr",{key:s.id,class:"hover:bg-blue-50/50 transition-colors"},[e("td",he,a(k(G)(s.dateTime)),1),e("td",ye,a(s.orderNo||"-"),1),e("td",we,[e("span",{class:J(["inline-flex rounded-full px-3 py-1 text-xs font-semibold leading-5",{"bg-orange-100 text-orange-800 border border-orange-200":s.type==="COD","bg-emerald-100 text-emerald-800 border border-emerald-200":s.type==="TRANSFER"}])},a(s.type||"N/A"),3)]),e("td",_e," ‡∏ø"+a(_(s.amount)),1)]))),128))])])])),g.value>1?(l(),n("div",ke,[e("div",De,[e("div",Ne,[t[9]||(t[9]=x(" ‡∏´‡∏ô‡πâ‡∏≤ ",-1)),e("span",Ce,a(r.value),1),t[10]||(t[10]=x(" ‡∏à‡∏≤‡∏Å ",-1)),e("span",Te,a(g.value),1)]),e("div",Fe,[e("button",{onClick:B,disabled:r.value===1,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[11]||(t[11]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),x(" ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ",-1)])],8,Se),e("button",{onClick:S,disabled:r.value===g.value,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[12]||(t[12]=[x(" ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ",-1),e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Be)])])])):X("",!0)]))])]),_:1}))}};export{Me as default};
