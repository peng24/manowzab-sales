import{B as $,r as v,c as x,C as q,D as A,o as H,e as r,f as e,q as L,E as O,t as a,h as b,w as P,G as z,F as _,i as k,g as R,a as I,k as Y,H as G,I as J,J as K,K as U,p as l,L as Q,y as D,z as N}from"./index-BSUyoH7K.js";import{A as W}from"./arrow-left-oQ29tJsJ.js";function X(m,y,d){return $(m,-7,d)}const Z={class:"container mx-auto max-w-6xl px-4 py-8"},ee={class:"mb-8"},te={class:"rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-700 p-6 md:p-8 shadow-lg"},se={class:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"},oe={class:"text-3xl md:text-4xl font-bold text-white"},ae={class:"flex flex-col gap-4 sm:flex-row sm:items-end lg:items-center"},re={class:"text-left sm:text-right"},le={class:"text-sm font-medium text-blue-100 mb-1"},ne={class:"text-xs ml-1"},de={class:"text-3xl md:text-4xl font-bold text-white"},ie={class:"flex flex-col gap-1"},ce=["value"],ue={key:0,class:"flex h-64 items-center justify-center"},xe={key:1,class:"rounded-2xl border border-gray-200 bg-white shadow-md overflow-hidden"},be={class:"border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},me={class:"text-lg font-bold text-gray-800"},ge={key:0,class:"px-6 py-12 text-center"},pe={key:1,class:"overflow-x-auto"},ve={class:"min-w-full divide-y divide-gray-200"},fe={class:"divide-y divide-gray-200 bg-white"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},he={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},we={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900"},ke={key:2,class:"border-t border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4"},De={class:"flex items-center justify-between"},Ne={class:"text-sm text-gray-700 font-medium"},Ce={class:"font-bold text-blue-600"},Te={class:"font-bold text-gray-900"},Me={class:"flex gap-2"},Se=["disabled"],Be=["disabled"],f=10,je={__name:"CustomerDetailView",props:{name:{type:String,required:!0}},setup(m){const y=m,d=v(!0),i=v([]),n=v(1),c=v("all"),h=[{value:"all",label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"},{value:"7days",label:"7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"},{value:"month",label:"‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ"},{value:"year",label:"‡∏õ‡∏µ‡∏ô‡∏µ‡πâ"}],C=x(()=>{const o=h.find(t=>t.value===c.value);return o?o.label:"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"}),g=x(()=>{if(c.value==="all")return i.value;const o=new Date;let t;switch(c.value){case"7days":t=X(o);break;case"month":t=A(o);break;case"year":t=q(o);break;default:return i.value}return i.value.filter(s=>(s.dateTime?.toDate?s.dateTime.toDate():new Date(s.dateTime))>=t)}),T=x(()=>g.value.reduce((o,t)=>{const s=parseFloat(t.amount);return o+(isNaN(s)?0:s)},0)),p=x(()=>Math.ceil(g.value.length/f)),M=x(()=>{const o=(n.value-1)*f,t=o+f;return g.value.slice(o,t)}),S=async()=>{d.value=!0;try{const o=I(Y,"sales"),t=G(o,J("customerName","==",y.name),K("dateTime","desc")),s=await U(t);i.value=s.docs.map(u=>({id:u.id,...u.data()}))}catch(o){console.error("Error fetching customer sales:",o)}finally{d.value=!1}},B=o=>{if(!o)return"-";const t=o.toDate?o.toDate():new Date(o),s=D(t,"d MMM",{locale:N}),u=t.getFullYear()+543,j=String(u).slice(-2),E=D(t,"HH:mm",{locale:N});return`${s} ${j} ${E} ‡∏ô.`},w=o=>{const t=parseFloat(o);return new Intl.NumberFormat("th-TH").format(isNaN(t)?0:t)},F=()=>{n.value<p.value&&n.value++},V=()=>{n.value>1&&n.value--};return H(()=>{S()}),(o,t)=>(l(),r("div",Z,[e("div",ee,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.back()),class:"mb-4 inline-flex items-center gap-2 bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:bg-gray-50 hover:text-blue-600 hover:border-blue-300 transition-all"},[L(O(W),{class:"h-5 w-5"}),t[2]||(t[2]=e("span",{class:"font-medium"},"‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö",-1))]),e("div",te,[e("div",se,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-blue-100 mb-2"},"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",-1)),e("h1",oe,a(m.name),1)]),e("div",ae,[e("div",re,[e("p",le,[t[4]||(t[4]=b(" ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏°",-1)),e("span",ne,"("+a(C.value)+")",1)]),e("h2",de," ‡∏ø"+a(w(T.value)),1)]),e("div",ie,[t[5]||(t[5]=e("label",{class:"text-xs font-medium text-blue-100"},"‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤",-1)),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s),class:"bg-white/95 border border-white/30 text-gray-700 text-sm rounded-lg focus:ring-2 focus:ring-white focus:border-white block px-3 py-2.5 shadow-md backdrop-blur-sm min-w-[150px]"},[(l(),r(_,null,k(h,s=>e("option",{key:s.value,value:s.value},a(s.label),9,ce)),64))],512),[[z,c.value]])])])])])]),d.value?(l(),r("div",ue,[...t[6]||(t[6]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),e("p",{class:"text-sm text-gray-500"},"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...")],-1)])])):(l(),r("div",xe,[e("div",be,[e("h3",me," üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ("+a(g.value.length)+" ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ",1)]),i.value.length===0?(l(),r("div",ge,[...t[7]||(t[7]=[e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"text-4xl"},"üì≠"),e("p",{class:"text-gray-500 font-medium"},"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠")],-1)])])):(l(),r("div",pe,[e("table",ve,[t[8]||(t[8]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Order No. "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó "),e("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ")])],-1)),e("tbody",fe,[(l(!0),r(_,null,k(M.value,s=>(l(),r("tr",{key:s.id,class:"hover:bg-blue-50/50 transition-colors"},[e("td",ye,a(B(s.dateTime)),1),e("td",he,a(s.orderNo||"-"),1),e("td",we,[e("span",{class:Q(["inline-flex rounded-full px-3 py-1 text-xs font-semibold leading-5",{"bg-orange-100 text-orange-800 border border-orange-200":s.type==="COD","bg-emerald-100 text-emerald-800 border border-emerald-200":s.type==="TRANSFER"}])},a(s.type||"N/A"),3)]),e("td",_e," ‡∏ø"+a(w(s.amount)),1)]))),128))])])])),p.value>1?(l(),r("div",ke,[e("div",De,[e("div",Ne,[t[9]||(t[9]=b(" ‡∏´‡∏ô‡πâ‡∏≤ ",-1)),e("span",Ce,a(n.value),1),t[10]||(t[10]=b(" ‡∏à‡∏≤‡∏Å ",-1)),e("span",Te,a(p.value),1)]),e("div",Me,[e("button",{onClick:V,disabled:n.value===1,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[11]||(t[11]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),b(" ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ",-1)])],8,Se),e("button",{onClick:F,disabled:n.value===p.value,class:"inline-flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-blue-400 hover:text-blue-600 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-white disabled:hover:border-gray-300 disabled:hover:text-gray-700 transition-all"},[...t[12]||(t[12]=[b(" ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ",-1),e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Be)])])])):R("",!0)]))]))}};export{je as default};
